{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\alex4\\\\OneDrive\\\\Documentos\\\\plantcare\\\\client\\\\src\\\\pages\\\\Plants.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Plants() {\n  _s();\n  const [plants, setPlants] = useState([]);\n  const [name, setName] = useState(\"\");\n  const [type, setType] = useState(\"\");\n  const [editing, setEditing] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const navigate = useNavigate();\n\n  // Verificar y limpiar el token al cargar el componente\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      console.error(\"No se encontró token en localStorage\");\n    } else {\n      console.log(\"Token encontrado:\", token);\n    }\n  }, []);\n\n  // Cargar las plantas de la base de datos\n  useEffect(() => {\n    cargarPlantas();\n  }, []);\n  const cargarPlantas = async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const token = localStorage.getItem('token');\n      if (!token) {\n        setError(\"No estás autenticado. Por favor inicia sesión.\");\n        return;\n      }\n\n      // Verificar estructura del token\n      if (token.split('.').length !== 3) {\n        console.error(\"Token con formato inválido\");\n        setError(\"Error de autenticación. Formato de token inválido.\");\n        return;\n      }\n      const res = await axios.get(\"http://localhost:5000/api/plants\", {\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        }\n      });\n      setPlants(res.data);\n    } catch (err) {\n      var _err$response, _err$response2, _err$response3, _err$response4;\n      console.error(\"Detalles del error:\", {\n        message: err.message,\n        response: (_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data,\n        status: (_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : _err$response2.status,\n        headers: (_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : _err$response3.headers,\n        config: err.config\n      });\n      if (((_err$response4 = err.response) === null || _err$response4 === void 0 ? void 0 : _err$response4.status) === 401) {\n        setError(\"Token inválido o expirado. Por favor vuelve a iniciar sesión.\");\n        // Opcional: limpiar token inválido\n        localStorage.removeItem('token');\n      } else {\n        var _err$response5, _err$response5$data;\n        setError(((_err$response5 = err.response) === null || _err$response5 === void 0 ? void 0 : (_err$response5$data = _err$response5.data) === null || _err$response5$data === void 0 ? void 0 : _err$response5$data.message) || \"Error al cargar las plantas\");\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // ... (resto de las funciones agregar, eliminar, editar se mantienen igual)\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      maxWidth: 600,\n      margin: \"60px auto\",\n      background: \"#fff\",\n      borderRadius: 20,\n      boxShadow: \"0 2px 16px #38764c18\",\n      padding: \"40px 28px\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      style: {\n        color: \"#38764c\"\n      },\n      children: \"Mis plantas\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this), loading && /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        textAlign: 'center'\n      },\n      children: \"Cargando plantas...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 19\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        background: '#fff8f8',\n        border: '1px solid #ffcccc',\n        borderRadius: '8px',\n        padding: '15px',\n        marginBottom: '20px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          color: '#d32f2f'\n        },\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate('/login'),\n        style: {\n          background: '#38764c',\n          color: 'white',\n          border: 'none',\n          padding: '10px 20px',\n          borderRadius: '5px',\n          cursor: 'pointer',\n          marginTop: '10px'\n        },\n        children: \"Ir a Iniciar Sesi\\xF3n\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 5\n  }, this);\n}\n_s(Plants, \"NXNUtQ2/bDNyzFkVwV3n6ZjKQ5c=\", false, function () {\n  return [useNavigate];\n});\n_c = Plants;\nvar _c;\n$RefreshReg$(_c, \"Plants\");","map":{"version":3,"names":["useState","useEffect","useNavigate","axios","jsxDEV","_jsxDEV","Plants","_s","plants","setPlants","name","setName","type","setType","editing","setEditing","loading","setLoading","error","setError","navigate","token","localStorage","getItem","console","log","cargarPlantas","split","length","res","get","headers","data","err","_err$response","_err$response2","_err$response3","_err$response4","message","response","status","config","removeItem","_err$response5","_err$response5$data","style","maxWidth","margin","background","borderRadius","boxShadow","padding","children","color","fileName","_jsxFileName","lineNumber","columnNumber","textAlign","border","marginBottom","onClick","cursor","marginTop","_c","$RefreshReg$"],"sources":["C:/Users/alex4/OneDrive/Documentos/plantcare/client/src/pages/Plants.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\n\r\nexport default function Plants() {\r\n  const [plants, setPlants] = useState([]);\r\n  const [name, setName] = useState(\"\");\r\n  const [type, setType] = useState(\"\");\r\n  const [editing, setEditing] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const navigate = useNavigate();\r\n\r\n  // Verificar y limpiar el token al cargar el componente\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      console.error(\"No se encontró token en localStorage\");\r\n    } else {\r\n      console.log(\"Token encontrado:\", token);\r\n    }\r\n  }, []);\r\n\r\n  // Cargar las plantas de la base de datos\r\n  useEffect(() => {\r\n    cargarPlantas();\r\n  }, []);\r\n\r\n  const cargarPlantas = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      \r\n      if (!token) {\r\n        setError(\"No estás autenticado. Por favor inicia sesión.\");\r\n        return;\r\n      }\r\n\r\n      // Verificar estructura del token\r\n      if (token.split('.').length !== 3) {\r\n        console.error(\"Token con formato inválido\");\r\n        setError(\"Error de autenticación. Formato de token inválido.\");\r\n        return;\r\n      }\r\n\r\n      const res = await axios.get(\"http://localhost:5000/api/plants\", {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n      \r\n      setPlants(res.data);\r\n    } catch (err) {\r\n      console.error(\"Detalles del error:\", {\r\n        message: err.message,\r\n        response: err.response?.data,\r\n        status: err.response?.status,\r\n        headers: err.response?.headers,\r\n        config: err.config\r\n      });\r\n\r\n      if (err.response?.status === 401) {\r\n        setError(\"Token inválido o expirado. Por favor vuelve a iniciar sesión.\");\r\n        // Opcional: limpiar token inválido\r\n        localStorage.removeItem('token');\r\n      } else {\r\n        setError(err.response?.data?.message || \"Error al cargar las plantas\");\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // ... (resto de las funciones agregar, eliminar, editar se mantienen igual)\r\n\r\n  return (\r\n    <div style={{\r\n      maxWidth: 600, margin: \"60px auto\", background: \"#fff\",\r\n      borderRadius: 20, boxShadow: \"0 2px 16px #38764c18\", padding: \"40px 28px\"\r\n    }}>\r\n      {/* Botón de regreso y otros elementos UI... */}\r\n\r\n      <h2 style={{ color: \"#38764c\" }}>Mis plantas</h2>\r\n      \r\n      {loading && <p style={{ textAlign: 'center' }}>Cargando plantas...</p>}\r\n      \r\n      {error && (\r\n        <div style={{ \r\n          background: '#fff8f8', \r\n          border: '1px solid #ffcccc',\r\n          borderRadius: '8px',\r\n          padding: '15px',\r\n          marginBottom: '20px'\r\n        }}>\r\n          <p style={{ color: '#d32f2f' }}>{error}</p>\r\n          <button \r\n            onClick={() => navigate('/login')}\r\n            style={{\r\n              background: '#38764c',\r\n              color: 'white',\r\n              border: 'none',\r\n              padding: '10px 20px',\r\n              borderRadius: '5px',\r\n              cursor: 'pointer',\r\n              marginTop: '10px'\r\n            }}\r\n          >\r\n            Ir a Iniciar Sesión\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Resto del componente... */}\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}